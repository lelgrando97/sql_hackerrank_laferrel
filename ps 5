/*
problem set 5
*/
select 
    h.hacker_id,
    h.name,
    sum(ms.max_score) as total_score
from (
    select 
        hacker_id,
        challenge_id,
        max(score) as max_score
    from submissions
    group by hacker_id, challenge_id
) ms
join hackers h
    on ms.hacker_id = h.hacker_id
group by h.hacker_id, h.name
having sum(ms.max_score) > 0
order by total_score desc, h.hacker_id asc;
